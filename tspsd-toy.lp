\ Model TSP-SD
\ LP format - for model browsing. Use MPS format to capture full model detail.
Minimize
  x[1,2,1] + x[1,2,2] + x[1,2,3] + x[1,2,4] + 1.414213562373095 x[1,3,1]
   + 1.414213562373095 x[1,3,2] + 1.414213562373095 x[1,3,3]
   + 1.414213562373095 x[1,3,4] + x[1,4,1] + x[1,4,2] + x[1,4,3] + x[1,4,4]
   + x[2,1,1] + x[2,1,2] + x[2,1,3] + x[2,1,4] + x[2,3,1] + x[2,3,2]
   + x[2,3,3] + x[2,3,4] + 1.414213562373095 x[2,4,1]
   + 1.414213562373095 x[2,4,2] + 1.414213562373095 x[2,4,3]
   + 1.414213562373095 x[2,4,4] + 1.414213562373095 x[3,1,1]
   + 1.414213562373095 x[3,1,2] + 1.414213562373095 x[3,1,3]
   + 1.414213562373095 x[3,1,4] + x[3,2,1] + x[3,2,2] + x[3,2,3] + x[3,2,4]
   + x[3,4,1] + x[3,4,2] + x[3,4,3] + x[3,4,4] + x[4,1,1] + x[4,1,2]
   + x[4,1,3] + x[4,1,4] + 1.414213562373095 x[4,2,1]
   + 1.414213562373095 x[4,2,2] + 1.414213562373095 x[4,2,3]
   + 1.414213562373095 x[4,2,4] + x[4,3,1] + x[4,3,2] + x[4,3,3] + x[4,3,4]
   + last_edge[1,2] + 1.414213562373095 last_edge[1,3] + last_edge[1,4]
   + last_edge[2,1] + last_edge[2,3] + 1.414213562373095 last_edge[2,4]
   + 1.414213562373095 last_edge[3,1] + last_edge[3,2] + last_edge[3,4]
   + last_edge[4,1] + 1.414213562373095 last_edge[4,2] + last_edge[4,3]
Subject To
 R0: last_edge[1,2] + last_edge[1,3] + last_edge[1,4] + last_edge[2,1]
   + last_edge[2,3] + last_edge[2,4] + last_edge[3,1] + last_edge[3,2]
   + last_edge[3,4] + last_edge[4,1] + last_edge[4,2] + last_edge[4,3] = 1
 each_node_visited_once_-_0: x[0,1,0] + x[0,2,0] + x[0,3,0] + x[0,4,0] = 1
 each_node_visited_once_-_1: x[1,2,1] + x[1,2,2] + x[1,2,3] + x[1,2,4]
   + x[1,3,1] + x[1,3,2] + x[1,3,3] + x[1,3,4] + x[1,4,1] + x[1,4,2]
   + x[1,4,3] + x[1,4,4] = 1
 each_node_visited_once_-_2: x[2,1,1] + x[2,1,2] + x[2,1,3] + x[2,1,4]
   + x[2,3,1] + x[2,3,2] + x[2,3,3] + x[2,3,4] + x[2,4,1] + x[2,4,2]
   + x[2,4,3] + x[2,4,4] = 1
 each_node_visited_once_-_3: x[3,1,1] + x[3,1,2] + x[3,1,3] + x[3,1,4]
   + x[3,2,1] + x[3,2,2] + x[3,2,3] + x[3,2,4] + x[3,4,1] + x[3,4,2]
   + x[3,4,3] + x[3,4,4] = 1
 each_node_visited_once_-_4: x[4,1,1] + x[4,1,2] + x[4,1,3] + x[4,1,4]
   + x[4,2,1] + x[4,2,2] + x[4,2,3] + x[4,2,4] + x[4,3,1] + x[4,3,2]
   + x[4,3,3] + x[4,3,4] = 1
 define_rank_node_1_time_1: x[1,2,1] + x[1,3,1] + x[1,4,1] - x[0,1,0] = 0
 define_rank_node_2_time_1: x[2,1,1] + x[2,3,1] + x[2,4,1] - x[0,2,0] = 0
 define_rank_node_3_time_1: x[3,1,1] + x[3,2,1] + x[3,4,1] - x[0,3,0] = 0
 define_rank_node_4_time_1: x[4,1,1] + x[4,2,1] + x[4,3,1] - x[0,4,0] = 0
 define_rank_node_1_time_2: x[1,2,2] + x[1,3,2] + x[1,4,2] - x[2,1,1]
   - x[3,1,1] - x[4,1,1] = 0
 define_rank_node_2_time_2: - x[1,2,1] + x[2,1,2] + x[2,3,2] + x[2,4,2]
   - x[3,2,1] - x[4,2,1] = 0
 define_rank_node_3_time_2: - x[1,3,1] - x[2,3,1] + x[3,1,2] + x[3,2,2]
   + x[3,4,2] - x[4,3,1] = 0
 define_rank_node_4_time_2: - x[1,4,1] - x[2,4,1] - x[3,4,1] + x[4,1,2]
   + x[4,2,2] + x[4,3,2] = 0
 define_rank_node_1_time_3: x[1,2,3] + x[1,3,3] + x[1,4,3] - x[2,1,2]
   - x[3,1,2] - x[4,1,2] = 0
 define_rank_node_2_time_3: - x[1,2,2] + x[2,1,3] + x[2,3,3] + x[2,4,3]
   - x[3,2,2] - x[4,2,2] = 0
 define_rank_node_3_time_3: - x[1,3,2] - x[2,3,2] + x[3,1,3] + x[3,2,3]
   + x[3,4,3] - x[4,3,2] = 0
 define_rank_node_4_time_3: - x[1,4,2] - x[2,4,2] - x[3,4,2] + x[4,1,3]
   + x[4,2,3] + x[4,3,3] = 0
 define_rank_node_1_time_4: x[1,2,4] + x[1,3,4] + x[1,4,4] - x[2,1,3]
   - x[3,1,3] - x[4,1,3] = 0
 define_rank_node_2_time_4: - x[1,2,3] + x[2,1,4] + x[2,3,4] + x[2,4,4]
   - x[3,2,3] - x[4,2,3] = 0
 define_rank_node_3_time_4: - x[1,3,3] - x[2,3,3] + x[3,1,4] + x[3,2,4]
   + x[3,4,4] - x[4,3,3] = 0
 define_rank_node_4_time_4: - x[1,4,3] - x[2,4,3] - x[3,4,3] + x[4,1,4]
   + x[4,2,4] + x[4,3,4] = 0
 each_time_one_node_-_0: x[0,1,0] + x[0,2,0] + x[0,3,0] + x[0,4,0] = 1
 each_time_one_node_-_2: x[1,2,2] + x[1,3,2] + x[1,4,2] + x[2,1,2]
   + x[2,3,2] + x[2,4,2] + x[3,1,2] + x[3,2,2] + x[3,4,2] + x[4,1,2]
   + x[4,2,2] + x[4,3,2] = 1
 each_time_one_node_-_3: x[1,2,3] + x[1,3,3] + x[1,4,3] + x[2,1,3]
   + x[2,3,3] + x[2,4,3] + x[3,1,3] + x[3,2,3] + x[3,4,3] + x[4,1,3]
   + x[4,2,3] + x[4,3,3] = 1
 each_time_one_node_-_4: x[1,2,4] + x[1,3,4] + x[1,4,4] + x[2,1,4]
   + x[2,3,4] + x[2,4,4] + x[3,1,4] + x[3,2,4] + x[3,4,4] + x[4,1,4]
   + x[4,2,4] + x[4,3,4] = 1
 del_1: x[1,3,1] + 2 x[1,3,2] + 3 x[1,3,3] + 4 x[1,3,4] <= 0
 del_2: x[3,1,1] + 2 x[3,1,2] + 3 x[3,1,3] + 4 x[3,1,4] <= 0
 R28: last_edge[1,3] = 0
 R29: last_edge[3,1] = 0
 del_1: x[2,4,1] + 2 x[2,4,2] + 3 x[2,4,3] + 4 x[2,4,4] <= 0
 del_2: x[4,2,1] + 2 x[4,2,2] + 3 x[4,2,3] + 4 x[4,2,4] <= 0
 R32: last_edge[2,4] = 0
 R33: last_edge[4,2] = 0
 del_1: x[1,2,1] + 2 x[1,2,2] + 3 x[1,2,3] + 4 x[1,2,4] <= 0
 del_2: x[2,1,1] + 2 x[2,1,2] + 3 x[2,1,3] + 4 x[2,1,4] <= 0
 R36: last_edge[1,2] = 0
 R37: last_edge[2,1] = 0
 del_1: x[2,3,1] + 2 x[2,3,2] + 3 x[2,3,3] + 4 x[2,3,4] <= 0
 del_2: x[3,2,1] + 2 x[3,2,2] + 3 x[3,2,3] + 4 x[3,2,4] <= 0
 R40: last_edge[2,3] = 0
 R41: last_edge[3,2] = 0
 del_1: x[3,4,1] + 2 x[3,4,2] + 3 x[3,4,3] + 4 x[3,4,4] <= 0
 del_2: x[4,3,1] + 2 x[4,3,2] + 3 x[4,3,3] + 4 x[4,3,4] <= 0
 R44: last_edge[3,4] = 0
 R45: last_edge[4,3] = 0
 last_edge_1-2: x[1,2,4] + x[3,2,4] + x[4,2,4] + x[0,1,0] - last_edge[1,2]
   <= 1
 last_edge_1-3: x[1,3,4] + x[2,3,4] + x[4,3,4] + x[0,1,0] - last_edge[1,3]
   <= 1
 last_edge_1-4: x[1,4,4] + x[2,4,4] + x[3,4,4] + x[0,1,0] - last_edge[1,4]
   <= 1
 last_edge_2-1: x[2,1,4] + x[3,1,4] + x[4,1,4] + x[0,2,0] - last_edge[2,1]
   <= 1
 last_edge_2-3: x[1,3,4] + x[2,3,4] + x[4,3,4] + x[0,2,0] - last_edge[2,3]
   <= 1
 last_edge_2-4: x[1,4,4] + x[2,4,4] + x[3,4,4] + x[0,2,0] - last_edge[2,4]
   <= 1
 last_edge_3-1: x[2,1,4] + x[3,1,4] + x[4,1,4] + x[0,3,0] - last_edge[3,1]
   <= 1
 last_edge_3-2: x[1,2,4] + x[3,2,4] + x[4,2,4] + x[0,3,0] - last_edge[3,2]
   <= 1
 last_edge_3-4: x[1,4,4] + x[2,4,4] + x[3,4,4] + x[0,3,0] - last_edge[3,4]
   <= 1
 last_edge_4-1: x[2,1,4] + x[3,1,4] + x[4,1,4] + x[0,4,0] - last_edge[4,1]
   <= 1
 last_edge_4-2: x[1,2,4] + x[3,2,4] + x[4,2,4] + x[0,4,0] - last_edge[4,2]
   <= 1
 last_edge_4-3: x[1,3,4] + x[2,3,4] + x[4,3,4] + x[0,4,0] - last_edge[4,3]
   <= 1
Bounds
Binaries
 x[1,2,1] x[1,2,2] x[1,2,3] x[1,2,4] x[1,3,1] x[1,3,2] x[1,3,3] x[1,3,4]
 x[1,4,1] x[1,4,2] x[1,4,3] x[1,4,4] x[2,1,1] x[2,1,2] x[2,1,3] x[2,1,4]
 x[2,3,1] x[2,3,2] x[2,3,3] x[2,3,4] x[2,4,1] x[2,4,2] x[2,4,3] x[2,4,4]
 x[3,1,1] x[3,1,2] x[3,1,3] x[3,1,4] x[3,2,1] x[3,2,2] x[3,2,3] x[3,2,4]
 x[3,4,1] x[3,4,2] x[3,4,3] x[3,4,4] x[4,1,1] x[4,1,2] x[4,1,3] x[4,1,4]
 x[4,2,1] x[4,2,2] x[4,2,3] x[4,2,4] x[4,3,1] x[4,3,2] x[4,3,3] x[4,3,4]
 x[0,1,0] x[0,2,0] x[0,3,0] x[0,4,0] last_edge[1,2] last_edge[1,3]
 last_edge[1,4] last_edge[2,1] last_edge[2,3] last_edge[2,4] last_edge[3,1]
 last_edge[3,2] last_edge[3,4] last_edge[4,1] last_edge[4,2] last_edge[4,3]
End
